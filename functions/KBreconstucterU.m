function ff=KBreconstucterU(U,s,mask,K,alpha,beta,k,wf)
%å¯¹è????sæ¯?ä¸???è¿?è¡?????ï¼?ff???????????©é?µï???s?????¥é??é¢?æµ?å¡????????©é??
%æ­¤å?½æ?°é???¨ä?s???¨è?/????ä¸ºé?¶ç?????µï???é¢?å¤?????s?¨è?/??ä¸ºé?¶ç??è¡?/??????
if nargin<8
    wf=[];
end

[m,n]=size(mask);
N=size(U,1);
LL=U*(repmat(wf,1,N).*U');   %%i.e. U*diag(wf)*U'

klk=alpha*K+beta*K*LL*K;
Uk=U(:,1:k);
ff=[];
for j=1:n
    labels=find(mask(:,j));
    if ~isempty(labels)
        yL=s(labels,j);
        KL=K(labels,:);
        a=(Uk'*(KL'*KL+klk)*Uk)\(Uk'*KL'*yL);
        f=K*Uk*a;
    end
    ff=[ff,f];
end